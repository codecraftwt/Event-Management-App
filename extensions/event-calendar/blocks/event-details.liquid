{% schema %}
{
  "name": "Event Details",
  "target": "section",
  "settings": []
}
{% endschema %}

<div id="event-detail">
  <p>Loading event details...</p>
</div>

<script>
(async () => {
  const container = document.getElementById('event-detail');

  // Get event_id from query string
  const urlParams = new URLSearchParams(window.location.search);
  const eventId = urlParams.get("event_id");

  try {
    const response = await fetch("https://sewing-til-never-fwd.trycloudflare.com/api/events");
    const events = await response.json();
    const event = events.find(e => e.id == eventId);

    if (!event) {
      container.innerHTML = "<p>Event not found.</p>";
      return;
    }

    container.innerHTML = `
      <div style="
        max-width:800px;
        margin:auto;
        padding:20px;
        background:#f1f3f6;
        border-radius:16px;
        box-shadow:5px 5px 15px #d1d9e6,-5px -5px 15px #ffffff;
      ">
        <h1 style="margin-bottom:10px;">${event.title}</h1>
        <img src="${event.image}" alt="${event.title}" style="width:100%;border-radius:12px;margin-bottom:10px;">
        <p><strong>Place:</strong> ${event.place}</p>
        <p><strong>Tag:</strong> ${event.tag}</p>
        <p><strong>Date:</strong> ${new Date(event.date).toLocaleDateString()} ${event.time}</p>
        <p><strong>Description:</strong> ${event.description}</p>
      </div>
    `;
  } catch (err) {
    console.error(err);
    container.innerHTML = "<p>Failed to load event.</p>";
  }
})();
</script>
